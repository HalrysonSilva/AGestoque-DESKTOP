object Formposicaoest: TFormposicaoest
  Left = 0
  Top = 0
  Caption = 'Formposicaoest'
  ClientHeight = 807
  ClientWidth = 1019
  Color = clBtnFace
  Font.Charset = ANSI_CHARSET
  Font.Color = clWindowText
  Font.Height = -13
  Font.Name = 'Segoe UI Semibold'
  Font.Style = [fsBold]
  OldCreateOrder = False
  Position = poMainFormCenter
  PixelsPerInch = 96
  TextHeight = 17
  object Panel1: TPanel
    Left = 0
    Top = 0
    Width = 1019
    Height = 409
    Align = alTop
    TabOrder = 0
    ExplicitWidth = 900
    object Label1: TLabel
      Left = 1
      Top = 1
      Width = 1017
      Height = 30
      Align = alTop
      Alignment = taCenter
      Caption = 'Produtos'
      Font.Charset = ANSI_CHARSET
      Font.Color = clWindowText
      Font.Height = -21
      Font.Name = 'Segoe UI Semibold'
      Font.Style = [fsBold]
      ParentFont = False
      ExplicitWidth = 88
    end
    object DBGridprodutos: TDBCtrlGrid
      AlignWithMargins = True
      Left = 4
      Top = 34
      Width = 1011
      Height = 371
      Align = alClient
      DataSource = DSQRYPRODUTOSABERTOS
      PanelHeight = 123
      PanelWidth = 994
      ParentColor = False
      TabOrder = 0
      ExplicitTop = 33
      ExplicitWidth = 1089
      object Panel3: TPanel
        Left = 0
        Top = 0
        Width = 113
        Height = 123
        Align = alLeft
        TabOrder = 0
        ExplicitLeft = -5
        ExplicitTop = 3
        object DBText2: TDBText
          Left = 1
          Top = 86
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'CodBarra'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 48
          ExplicitTop = 48
          ExplicitWidth = 65
        end
        object Label4: TLabel
          Left = 1
          Top = 69
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Cod Barra'
          ExplicitWidth = 60
        end
        object Label6: TLabel
          Left = 1
          Top = 35
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Cod Fornecedor'
          ExplicitWidth = 97
        end
        object DBText4: TDBText
          Left = 1
          Top = 52
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'CodFornecedor'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 2
          ExplicitTop = 26
        end
        object Label7: TLabel
          Left = 1
          Top = 1
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Codinterno'
          ExplicitWidth = 68
        end
        object DBText5: TDBText
          Left = 1
          Top = 18
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'CodInterno'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 2
          ExplicitTop = 26
        end
      end
      object Panel4: TPanel
        Left = 113
        Top = 0
        Width = 655
        Height = 123
        Align = alClient
        TabOrder = 1
        ExplicitLeft = 118
        ExplicitTop = 3
        ExplicitWidth = 480
        object DBText1: TDBText
          Left = 1
          Top = 18
          Width = 653
          Height = 17
          Align = alTop
          DataField = 'Produto'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 2
          ExplicitTop = 9
          ExplicitWidth = 478
        end
        object Label3: TLabel
          Left = 1
          Top = 35
          Width = 653
          Height = 17
          Align = alTop
          Caption = 'Fornecedor'
          ExplicitWidth = 69
        end
        object DBText11: TDBText
          Left = 1
          Top = 52
          Width = 653
          Height = 17
          Align = alTop
          DataField = 'Fornecedor'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 6
          ExplicitTop = 92
        end
        object Label13: TLabel
          Left = 1
          Top = 1
          Width = 653
          Height = 17
          Align = alTop
          Caption = 'Produto'
          ExplicitWidth = 50
        end
      end
      object Panel5: TPanel
        Left = 881
        Top = 0
        Width = 113
        Height = 123
        Align = alRight
        TabOrder = 2
        ExplicitLeft = 784
        ExplicitTop = 3
        object DBText3: TDBText
          Left = 1
          Top = 86
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'QtdReserva'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 48
          ExplicitTop = 48
          ExplicitWidth = 65
        end
        object Label5: TLabel
          Left = 1
          Top = 69
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Reservado'
          ExplicitWidth = 64
        end
        object Label8: TLabel
          Left = 1
          Top = 35
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Estoque'
          ExplicitWidth = 49
        end
        object DBText6: TDBText
          Left = 1
          Top = 52
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'QtdEstoque'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 2
          ExplicitTop = 26
        end
        object Label9: TLabel
          Left = 1
          Top = 1
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'N'#186' Pedidos'
          ExplicitWidth = 68
        end
        object DBText7: TDBText
          Left = 1
          Top = 18
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'NumPedidos'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 2
          ExplicitTop = 26
        end
      end
      object Panel6: TPanel
        Left = 768
        Top = 0
        Width = 113
        Height = 123
        Align = alRight
        TabOrder = 3
        ExplicitLeft = 773
        ExplicitTop = 3
        object DBText8: TDBText
          Left = 1
          Top = 86
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'Localizacao'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 48
          ExplicitTop = 48
          ExplicitWidth = 65
        end
        object Label10: TLabel
          Left = 1
          Top = 69
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Localiza'#231#227'o'
          ExplicitLeft = 6
          ExplicitTop = 75
        end
        object Label11: TLabel
          Left = 1
          Top = 35
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Marca'
          ExplicitWidth = 37
        end
        object DBText9: TDBText
          Left = 1
          Top = 52
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'Marca'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 2
          ExplicitTop = 26
        end
        object Label12: TLabel
          Left = 1
          Top = 1
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Grupo'
          ExplicitWidth = 38
        end
        object DBText10: TDBText
          Left = 1
          Top = 18
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'Grupo'
          DataSource = DSQRYPRODUTOSABERTOS
          ExplicitLeft = 2
          ExplicitTop = 26
        end
      end
    end
  end
  object Panel2: TPanel
    Left = 0
    Top = 409
    Width = 1019
    Height = 398
    Align = alClient
    TabOrder = 1
    ExplicitTop = 297
    ExplicitWidth = 835
    ExplicitHeight = 335
    object Label2: TLabel
      Left = 1
      Top = 1
      Width = 1017
      Height = 30
      Align = alTop
      Alignment = taCenter
      Caption = 'Pedidos'
      Font.Charset = ANSI_CHARSET
      Font.Color = clWindowText
      Font.Height = -21
      Font.Name = 'Segoe UI Semibold'
      Font.Style = [fsBold]
      ParentFont = False
      ExplicitWidth = 75
    end
    object DBGridpedidos: TDBCtrlGrid
      AlignWithMargins = True
      Left = 4
      Top = 34
      Width = 1011
      Height = 360
      Align = alClient
      DataSource = DSQRYPEDIDOS
      PanelHeight = 120
      PanelWidth = 994
      ParentColor = False
      TabOrder = 0
      ExplicitLeft = 5
      ExplicitTop = 37
      object Panel7: TPanel
        Left = 113
        Top = 0
        Width = 200
        Height = 120
        Align = alLeft
        TabOrder = 0
        object Label15: TLabel
          Left = 1
          Top = 48
          Width = 198
          Height = 17
          Align = alTop
          Caption = 'Pedido'
          ExplicitTop = 35
          ExplicitWidth = 42
        end
        object DBText13: TDBText
          Left = 1
          Top = 65
          Width = 198
          Height = 17
          Align = alTop
          DataField = 'Pedido'
          DataSource = DSQRYPEDIDOS
          ExplicitLeft = 2
          ExplicitTop = 26
          ExplicitWidth = 111
        end
        object Label16: TLabel
          Left = 1
          Top = 1
          Width = 198
          Height = 17
          Align = alTop
          Caption = 'Status'
          ExplicitWidth = 38
        end
        object DBText14: TDBText
          Left = 1
          Top = 18
          Width = 198
          Height = 30
          Align = alTop
          DataField = 'Status'
          DataSource = DSQRYPEDIDOS
          Font.Charset = ANSI_CHARSET
          Font.Color = clWindowText
          Font.Height = -21
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          ParentFont = False
        end
      end
      object Panel8: TPanel
        Left = 313
        Top = 0
        Width = 568
        Height = 120
        Align = alClient
        TabOrder = 1
        ExplicitLeft = 113
        ExplicitWidth = 488
        object DBText15: TDBText
          Left = 1
          Top = 18
          Width = 566
          Height = 17
          Align = alTop
          DataField = 'Cliente'
          DataSource = DSQRYPEDIDOS
          ExplicitLeft = 2
          ExplicitTop = 9
          ExplicitWidth = 478
        end
        object Label17: TLabel
          Left = 1
          Top = 35
          Width = 566
          Height = 17
          Align = alTop
          Caption = 'Vendedor'
          ExplicitWidth = 58
        end
        object Label18: TLabel
          Left = 1
          Top = 1
          Width = 566
          Height = 17
          Align = alTop
          Caption = 'Cliente'
          ExplicitWidth = 41
        end
        object DBText18: TDBText
          Left = 1
          Top = 52
          Width = 566
          Height = 17
          Align = alTop
          DataField = 'Vendedor'
          DataSource = DSQRYPEDIDOS
          ExplicitLeft = 5
          ExplicitTop = 71
        end
      end
      object Panel9: TPanel
        Left = 881
        Top = 0
        Width = 113
        Height = 120
        Align = alRight
        TabOrder = 2
        ExplicitLeft = 784
        ExplicitTop = 3
        ExplicitHeight = 123
        object Label20: TLabel
          Left = 1
          Top = 69
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Total'
          ExplicitTop = 35
          ExplicitWidth = 29
        end
        object Label21: TLabel
          Left = 1
          Top = 1
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Quantidade'
          ExplicitWidth = 71
        end
        object DBText16: TDBText
          Left = 1
          Top = 18
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'QuantidadeItem'
          DataSource = DSQRYPEDIDOS
          ExplicitLeft = 2
          ExplicitTop = 26
        end
        object DBText17: TDBText
          Left = 1
          Top = 52
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'Situacao'
          DataSource = DSQRYPEDIDOS
          ExplicitLeft = 6
          ExplicitTop = 41
        end
        object DBText19: TDBText
          Left = 1
          Top = 86
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'TOTAL'
          DataSource = DSQRYPEDIDOS
          ExplicitLeft = 2
          ExplicitTop = 60
        end
        object Label19: TLabel
          Left = 1
          Top = 35
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Situa'#231#227'o'
          ExplicitWidth = 51
        end
      end
      object Panel10: TPanel
        Left = 0
        Top = 0
        Width = 113
        Height = 120
        Align = alLeft
        TabOrder = 3
        ExplicitLeft = 8
        object Label23: TLabel
          Left = 1
          Top = 35
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Data'
          ExplicitWidth = 28
        end
        object DBText20: TDBText
          Left = 1
          Top = 18
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'Controle'
          DataSource = DSQRYPEDIDOS
          ExplicitLeft = 2
          ExplicitTop = 26
        end
        object Label14: TLabel
          Left = 1
          Top = 1
          Width = 111
          Height = 17
          Align = alTop
          Caption = 'Controle'
          ExplicitWidth = 52
        end
        object DBText12: TDBText
          Left = 1
          Top = 52
          Width = 111
          Height = 17
          Align = alTop
          DataField = 'Data'
          DataSource = DSQRYPEDIDOS
          ExplicitLeft = 9
          ExplicitTop = 75
        end
      end
    end
  end
  object QRYPRODUTOSABERTOS: TUniQuery
    Connection = DataModule1.ConDados
    SQL.Strings = (
      'SELECT'
      '    B.LkProduto AS LkProduto,'
      '    P.CodInterno,'
      '    P.Produto,'
      '    P.CodBarra,'
      '    P.CodFornecedor,'
      '    P.Moeda AS Localizacao,'
      '    G.Setor AS Grupo,'
      '    P.Fabricante AS Marca,'
      '    F.Empresa AS Fornecedor,'
      '    P.Quantidade AS QtdEstoque,'
      '    CAST(SUM(B.Qtdreal) AS NUMERIC(12, 2)) AS QtdReserva,'
      '    COUNT(DISTINCT A.Pedido) AS NumPedidos'
      'FROM'
      '    TabEst3B B WITH (NOLOCK)'
      'INNER JOIN'
      '    TabEst3A A WITH (NOLOCK) ON A.Pedido = B.PEDIDO'
      'INNER JOIN'
      '    TABEST1 P WITH (NOLOCK) ON P.Controle = B.LkProduto'
      'LEFT JOIN'
      '    TabEst8 G WITH (NOLOCK) ON P.LkSetor = G.Controle'
      'LEFT JOIN'
      '    TabFor F WITH (NOLOCK) ON P.LkFornec = F.Controle'
      'WHERE'
      '    A.Cancelada <> 1 -- Pedido n'#227'o cancelado'
      '    AND A.VENDA <> 1 -- Pedido n'#227'o faturado (n'#227'o '#233' venda)'
      '    AND A.STATUS IN ('#39'O'#39') -- Filtro de Status Aberto/Or'#231'amento'
      
        '    AND P.Controle = :LkProduto -- Filtro pelo c'#243'digo do produto' +
        ' (par'#226'metro)'
      'GROUP BY'
      
        '    B.LkProduto, P.CodInterno, P.Produto, P.Quantidade, P.CodFor' +
        'necedor, P.Moeda,'
      '    G.Setor, P.Fabricante, F.Empresa, P.CodBarra'
      'ORDER BY'
      '    P.Produto;')
    AfterScroll = QRYPRODUTOSABERTOSAfterScroll
    Left = 325
    Top = 304
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'LkProduto'
        Value = Null
      end>
    object QRYPRODUTOSABERTOSLkProduto: TIntegerField
      FieldName = 'LkProduto'
    end
    object QRYPRODUTOSABERTOSCodInterno: TStringField
      FieldName = 'CodInterno'
      ReadOnly = True
      Size = 30
    end
    object QRYPRODUTOSABERTOSProduto: TStringField
      FieldName = 'Produto'
      ReadOnly = True
      Size = 80
    end
    object QRYPRODUTOSABERTOSCodBarra: TStringField
      FieldName = 'CodBarra'
      ReadOnly = True
    end
    object QRYPRODUTOSABERTOSCodFornecedor: TStringField
      FieldName = 'CodFornecedor'
      ReadOnly = True
    end
    object QRYPRODUTOSABERTOSLocalizacao: TStringField
      FieldName = 'Localizacao'
      ReadOnly = True
    end
    object QRYPRODUTOSABERTOSGrupo: TStringField
      FieldName = 'Grupo'
      ReadOnly = True
      Size = 30
    end
    object QRYPRODUTOSABERTOSMarca: TStringField
      FieldName = 'Marca'
      ReadOnly = True
    end
    object QRYPRODUTOSABERTOSFornecedor: TStringField
      FieldName = 'Fornecedor'
      ReadOnly = True
      Size = 60
    end
    object QRYPRODUTOSABERTOSQtdEstoque: TFloatField
      FieldName = 'QtdEstoque'
      ReadOnly = True
    end
    object QRYPRODUTOSABERTOSQtdReserva: TFloatField
      FieldName = 'QtdReserva'
      ReadOnly = True
    end
    object QRYPRODUTOSABERTOSNumPedidos: TIntegerField
      FieldName = 'NumPedidos'
      ReadOnly = True
    end
  end
  object DSQRYPRODUTOSABERTOS: TDataSource
    DataSet = QRYPRODUTOSABERTOS
    Left = 205
    Top = 304
  end
  object QRYPEDIDOS: TUniQuery
    Connection = DataModule1.ConDados
    SQL.Strings = (
      'SELECT'
      '    A.Controle, -- Mantendo o campo Controle'
      '    A.Data,     -- Mantendo o campo Data'
      '    CASE'
      
        '        WHEN A.STATUS = '#39'P'#39' THEN '#39'PR'#201'-VENDA'#39' -- Exibe o nome com' +
        'pleto'
      
        '        WHEN A.STATUS = '#39'O'#39' THEN '#39'OR'#199'AMENTO'#39' -- Exibe o nome com' +
        'pleto'
      '        ELSE '#39'OUTROS'#39
      
        '    END AS Status, -- Renomeando a coluna A.Status para exibir o' +
        ' nome'
      '    A.Pedido,'
      '    -- ... outras colunas de A'
      '    A.Cliente,  -- Assumindo que o nome do cliente est'#225' em A'
      '    A.Vendedor, -- Assumindo que o vendedor est'#225' em A'
      '    B.Qtdreal AS QuantidadeItem,'
      '    A.Total,'
      '    -- ... o restante da query'
      '    CASE'
      '        WHEN A.STATUS = '#39'P'#39' THEN '#39'PR'#201'-VENDA'#39
      '        WHEN A.STATUS = '#39'O'#39' THEN '#39'OR'#199'AMENTO'#39
      '        ELSE '#39'OUTROS'#39
      '    END AS Situacao -- Mantendo o Situacao, se necess'#225'rio'
      'FROM'
      '    TabEst3A A WITH (NOLOCK)'
      'INNER JOIN'
      '    TabEst3B B WITH (NOLOCK) ON A.Pedido = B.PEDIDO'
      'WHERE'
      '    A.Cancelada <> 1'
      '    AND A.VENDA <> 1'
      '    AND A.STATUS IN ('#39'P'#39', '#39'O'#39')'
      '    AND B.LkProduto = :LkProduto'
      'ORDER BY'
      '    A.Pedido DESC;')
    Left = 61
    Top = 296
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'LkProduto'
        Value = Null
      end>
    object QRYPEDIDOSControle: TIntegerField
      FieldName = 'Controle'
      Required = True
    end
    object QRYPEDIDOSData: TDateTimeField
      FieldName = 'Data'
    end
    object QRYPEDIDOSStatus: TStringField
      FieldName = 'Status'
      ReadOnly = True
      Required = True
      Size = 9
    end
    object QRYPEDIDOSPedido: TIntegerField
      FieldName = 'Pedido'
      Required = True
    end
    object QRYPEDIDOSCliente: TStringField
      FieldName = 'Cliente'
      Size = 40
    end
    object QRYPEDIDOSVendedor: TStringField
      FieldName = 'Vendedor'
    end
    object QRYPEDIDOSQuantidadeItem: TFloatField
      FieldName = 'QuantidadeItem'
      ReadOnly = True
    end
    object QRYPEDIDOSTotal: TFloatField
      FieldName = 'Total'
    end
    object QRYPEDIDOSSituacao: TStringField
      FieldName = 'Situacao'
      ReadOnly = True
      Required = True
      Size = 9
    end
  end
  object DSQRYPEDIDOS: TDataSource
    DataSet = QRYPEDIDOS
    Left = 69
    Top = 376
  end
  object QRYCODINTERNO: TUniQuery
    Connection = DataModule1.ConDados
    Left = 144
    Top = 256
  end
end
